CREATE DATABASE PROJETO02;
SHOW DATABASES;
USE PROJETO02;

DROP TABLE RELATORIO;
DROP TABLE CATRACA;
DROP TABLE ALUNOS;

SHOW TABLES;

SELECT * FROM ALUNOS;

SELECT * FROM CATRACA;

SELECT * FROM RELATORIO;

TRUNCATE ALUNOS;

TRUNCATE CATRACA;

TRUNCATE RELATORIO;

CREATE TABLE ALUNOS (
    MATRICULA INT AUTO_INCREMENT PRIMARY KEY,
    NOME VARCHAR(100) NOT NULL,
    CPF VARCHAR (15) NOT NULL UNIQUE,
    EMAIL VARCHAR(100) NOT NULL UNIQUE,
    ALTURA INT NOT NULL,
    PESO INT NOT NULL
);

CREATE TABLE CATRACA (
    ID_CATRACA INT AUTO_INCREMENT PRIMARY KEY,
    ID_ALUNO INT NOT NULL,
    HORARIO_INICIO DATETIME NOT NULL,
    HORARIO_SAIDA DATETIME NULL,
    CONSTRAINT FK_ID_ALUNO 
		FOREIGN KEY (ID_ALUNO) 
        REFERENCES ALUNOS(MATRICULA)
);
    
CREATE TABLE RELATORIO (
    ID_RELATORIO INT AUTO_INCREMENT PRIMARY KEY,
    ID_ALUNO INT NOT NULL,
    HORAS_TOTAIS TIME NOT NULL DEFAULT '00:00:00',
    HORAS_SEMANAIS TIME NOT NULL DEFAULT '00:00:00',
    CLASSIFICACAO_TOTAL VARCHAR(50) NOT NULL DEFAULT 'Iniciante',
    CLASSIFICACAO_SEMANAL VARCHAR(50) NOT NULL DEFAULT 'Iniciante',
    CONSTRAINT FK_ALUNO_HORAS
        FOREIGN KEY (ID_ALUNO)
        REFERENCES ALUNOS (MATRICULA)
);

-- Inserção de registros para o aluno 1 para classificação semanal (últimos 7 dias)
INSERT INTO CATRACA (ID_ALUNO, HORARIO_INICIO, HORARIO_SAIDA) 
VALUES 
(1, '2024-11-26 09:00:00', '2024-11-26 11:00:00'), -- 2 horas no dia 26/11/2024
(1, '2024-11-26 10:00:00', '2024-11-26 13:30:00'), -- 3,5 horas no dia 26/11/2024
(1, '2024-11-28 14:00:00', '2024-11-28 17:00:00'); -- 3 horas no dia 28/11/2024

-- Inserção de registros para o aluno 1 para classificação total (qualquer data)
INSERT INTO CATRACA (ID_ALUNO, HORARIO_INICIO, HORARIO_SAIDA) 
VALUES 
(1, '2024-10-15 08:30:00', '2024-10-15 12:30:00'), -- 4 horas no dia 15/10/2024
(1, '2024-09-30 07:00:00', '2024-09-30 11:30:00'); -- 4,5 horas no dia 30/09/2024


-- Inserção de registros para o aluno 2 para classificação semanal (últimos 7 dias)
INSERT INTO CATRACA (ID_ALUNO, HORARIO_INICIO, HORARIO_SAIDA) 
VALUES 
(2, '2024-11-26 08:00:00', '2024-11-26 11:00:00'), -- 3 horas no dia 26/11/2024
(2, '2024-11-27 09:30:00', '2024-11-27 12:00:00'), -- 2,5 horas no dia 27/11/2024
(2, '2024-11-29 14:00:00', '2024-11-29 17:30:00'); -- 3,5 horas no dia 29/11/2024

-- Inserção de registros para o aluno 2 para classificação total (qualquer data)
INSERT INTO CATRACA (ID_ALUNO, HORARIO_INICIO, HORARIO_SAIDA) 
VALUES 
(2, '2024-08-20 08:00:00', '2024-08-20 12:00:00'), -- 4 horas no dia 20/08/2024
(2, '2024-06-10 07:00:00', '2024-06-10 10:00:00'); -- 3 horas no dia 10/06/2024
